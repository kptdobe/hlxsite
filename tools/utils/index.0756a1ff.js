var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},i={},n=e.parcelRequire99f1;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in i){var n=i[e];delete i[e];var r={id:e,exports:{}};return t[e]=r,n.call(r.exports,r,r.exports),r.exports}var a=new Error("Cannot find module '"+e+"'");throw (a.code="MODULE_NOT_FOUND", a)}).register=function(e,t){i[e]=t},e.parcelRequire99f1=n);var r=n("3eT87"),a=n("baa6D");const s=async(e,t,i)=>{const n=e.length;let r=0;const s=async e=>{const s=a.toHelixConfig(e),l=`https://admin.hlx.page/${t}/${s.owner}/${s.repo}/${s.ref}${s.path}`,o=await fetch(l,{method:"POST"}),d=await o.json();r+=1,i&&i.call(null,e,t,r,n,l,d)},l=async()=>{for(;e.length;){const t=e.shift();await s(t)}},o="live"===t?40:5,d=[];for(let e=0;e<o;e+=1)d.push(l());await Promise.all(d)},l=document.querySelector(".pp #previewButton"),o=document.querySelector(".pp #publishButton"),d=document.querySelector(".pp #ppButton"),p=document.getElementById("ppStatus"),u=document.getElementById("ppResults"),c={},b=()=>c.fields.ppURLs.split("\n").map((e=>e.trim())),f=()=>{p.innerHTML="",u.innerHTML=""},m=(e,t,i)=>{let n=p.querySelector("sp-progress-bar"),r=p.querySelector("div");n||(n=document.createElement("sp-progress-bar"),n.setAttribute("size","m"),n.setAttribute("label",`${e} in progress...`),p.appendChild(n),r=document.createElement("div"),p.appendChild(r)),t===i&&n.setAttribute("label",`${e} done.`),n.setAttribute("progress",Math.floor(100*t/i)),r.innerHTML=`${e}: ${t} / ${i}`},w=(e,t,i)=>{const n=document.createElement("p");n.innerHTML=`${t} / ${e}: `;const r=document.createElement("sp-link");r.setAttribute("size","m"),r.setAttribute("target","_blank"),r.setAttribute("href",i),r.innerHTML=i,n.append(r),u.appendChild(n)},h=()=>{l.setAttribute("disabled","true"),o.setAttribute("disabled","true"),d.setAttribute("disabled","true")},v=()=>{l.removeAttribute("disabled"),o.removeAttribute("disabled"),d.removeAttribute("disabled")},y=async()=>{const e=b();await(async(e,t)=>{await s(e,"preview",t)})(e,((e,t,i,n,r,a)=>{m("Preview",i,n),w("Preview",i,a.preview.url)}))},g=async()=>{const e=b();await(async(e,t)=>{await s(e,"live",t)})(e,((e,t,i,n,r,a)=>{m("Publish",i,n),w("Publish",i,a.live.url)}))};c.fields=r.initOptionFields(".pp"),r.attachOptionFieldsListeners(c.fields,".pp"),l.addEventListener("click",(async()=>{h(),f(),await y(),v()})),o.addEventListener("click",(async()=>{h(),f(),await g(),v()})),d.addEventListener("click",(async()=>{h(),f(),await y(),await g(),v()}));
//# sourceMappingURL=index.0756a1ff.js.map
